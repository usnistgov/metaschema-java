<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbstractComparison.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Metaschema Core API</a> &gt; <a href="index.source.html" class="el_package">gov.nist.secauto.metaschema.core.metapath</a> &gt; <span class="el_source">AbstractComparison.java</span></div><h1>AbstractComparison.java</h1><pre class="source lang-java linenums">/*
 * Portions of this software was developed by employees of the National Institute
 * of Standards and Technology (NIST), an agency of the Federal Government and is
 * being made available as a public service. Pursuant to title 17 United States
 * Code Section 105, works of NIST employees are not subject to copyright
 * protection in the United States. This software may be subject to foreign
 * copyright. Permission in the United States and in foreign countries, to the
 * extent that NIST may hold copyright, to use, copy, modify, create derivative
 * works, and distribute this software and its documentation without fee is hereby
 * granted on a non-exclusive basis, provided that this notice and disclaimer
 * of warranty appears in all copies.
 *
 * THE SOFTWARE IS PROVIDED 'AS IS' WITHOUT ANY WARRANTY OF ANY KIND, EITHER
 * EXPRESSED, IMPLIED, OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, ANY WARRANTY
 * THAT THE SOFTWARE WILL CONFORM TO SPECIFICATIONS, ANY IMPLIED WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND FREEDOM FROM
 * INFRINGEMENT, AND ANY WARRANTY THAT THE DOCUMENTATION WILL CONFORM TO THE
 * SOFTWARE, OR ANY WARRANTY THAT THE SOFTWARE WILL BE ERROR FREE.  IN NO EVENT
 * SHALL NIST BE LIABLE FOR ANY DAMAGES, INCLUDING, BUT NOT LIMITED TO, DIRECT,
 * INDIRECT, SPECIAL OR CONSEQUENTIAL DAMAGES, ARISING OUT OF, RESULTING FROM,
 * OR IN ANY WAY CONNECTED WITH THIS SOFTWARE, WHETHER OR NOT BASED UPON WARRANTY,
 * CONTRACT, TORT, OR OTHERWISE, WHETHER OR NOT INJURY WAS SUSTAINED BY PERSONS OR
 * PROPERTY OR OTHERWISE, AND WHETHER OR NOT LOSS WAS SUSTAINED FROM, OR AROSE OUT
 * OF THE RESULTS OF, OR USE OF, THE SOFTWARE OR SERVICES PROVIDED HEREUNDER.
 */

package gov.nist.secauto.metaschema.core.metapath;

import gov.nist.secauto.metaschema.core.metapath.function.OperationFunctions;
import gov.nist.secauto.metaschema.core.metapath.function.library.FnNot;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IAnyAtomicItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IBase64BinaryItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IBooleanItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDateItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDateTimeItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDayTimeDurationItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDurationItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IIntegerItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.INumericItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IStringItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IYearMonthDurationItem;
import gov.nist.secauto.metaschema.core.util.ObjectUtils;

import java.util.Locale;

import edu.umd.cs.findbugs.annotations.NonNull;

/**
 * A common base class for all comparison nodes, which consist of two
 * expressions representing the left and right sides of the comparison, and a
 * comparison operator.
 */
abstract class AbstractComparison // NOPMD - unavoidable
    extends AbstractBinaryExpression&lt;IExpression, IExpression&gt;
    implements IComparison {

  @NonNull
  private final Operator operator;

  /**
   * Construct an expression that compares the result of the {@code right}
   * expression with the result of the {@code left} expression using the specified
   * {@code operator}.
   *
   * @param left
   *          the expression to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the expression to compare with
   */
  public AbstractComparison(@NonNull IExpression left, @NonNull Operator operator, @NonNull IExpression right) {
<span class="fc" id="L73">    super(left, right);</span>
<span class="fc" id="L74">    this.operator = ObjectUtils.requireNonNull(operator, &quot;operator&quot;);</span>
<span class="fc" id="L75">  }</span>

  /**
   * Get the comparison operator.
   *
   * @return the operator
   */
  @NonNull
  public Operator getOperator() {
<span class="fc" id="L84">    return operator;</span>
  }

  @SuppressWarnings(&quot;null&quot;)
  @Override
  public String toASTString() {
<span class="nc" id="L90">    return String.format(&quot;%s[operator=%s]&quot;, getClass().getName(), operator);</span>
  }

  /**
   * Compare the {@code right} item with the {@code left} item using the specified
   * {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  protected IBooleanItem compare( // NOPMD - unavoidable
      @NonNull IAnyAtomicItem left,
      @NonNull Operator operator,
      @NonNull IAnyAtomicItem right) {
    @NonNull IBooleanItem retval;
<span class="pc bpc" id="L111" title="1 of 4 branches missed.">    if (left instanceof IStringItem || right instanceof IStringItem) {</span>
<span class="fc" id="L112">      retval = stringCompare(IStringItem.cast(left), operator, IStringItem.cast(right));</span>
<span class="pc bpc" id="L113" title="1 of 4 branches missed.">    } else if (left instanceof INumericItem &amp;&amp; right instanceof INumericItem) {</span>
<span class="fc" id="L114">      retval = numericCompare((INumericItem) left, operator, (INumericItem) right);</span>
<span class="pc bpc" id="L115" title="2 of 4 branches missed.">    } else if (left instanceof IBooleanItem &amp;&amp; right instanceof IBooleanItem) {</span>
<span class="fc" id="L116">      retval = booleanCompare((IBooleanItem) left, operator, (IBooleanItem) right);</span>
<span class="nc bnc" id="L117" title="All 4 branches missed.">    } else if (left instanceof IDateTimeItem &amp;&amp; right instanceof IDateTimeItem) {</span>
<span class="nc" id="L118">      retval = dateTimeCompare((IDateTimeItem) left, operator, (IDateTimeItem) right);</span>
<span class="nc bnc" id="L119" title="All 4 branches missed.">    } else if (left instanceof IDateItem &amp;&amp; right instanceof IDateItem) {</span>
<span class="nc" id="L120">      retval = dateCompare((IDateItem) left, operator, (IDateItem) right);</span>
<span class="nc bnc" id="L121" title="All 4 branches missed.">    } else if (left instanceof IDurationItem &amp;&amp; right instanceof IDurationItem) {</span>
<span class="nc" id="L122">      retval = durationCompare((IDurationItem) left, operator, (IDurationItem) right);</span>
<span class="nc bnc" id="L123" title="All 4 branches missed.">    } else if (left instanceof IBase64BinaryItem &amp;&amp; right instanceof IBase64BinaryItem) {</span>
<span class="nc" id="L124">      retval = binaryCompare((IBase64BinaryItem) left, operator, (IBase64BinaryItem) right);</span>
    } else {
<span class="nc" id="L126">      throw new InvalidTypeMetapathException(</span>
          null,
<span class="nc" id="L128">          String.format(&quot;invalid types for comparison: %s %s %s&quot;, left.getClass().getName(),</span>
<span class="nc" id="L129">              operator.name().toLowerCase(Locale.ROOT), right.getClass().getName()));</span>
    }
<span class="fc" id="L131">    return retval;</span>
  }

  /**
   * Perform a string-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem stringCompare(@NonNull IStringItem left, @NonNull Operator operator,
      @NonNull IStringItem right) {
    IBooleanItem retval;
<span class="pc bpc" id="L150" title="1 of 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="fc" id="L152">      retval = OperationFunctions.opNumericEqual(left.compare(right), IIntegerItem.ZERO);</span>
<span class="fc" id="L153">      break;</span>
    case GE:
<span class="fc" id="L155">      retval = OperationFunctions.opNumericGreaterThan(left.compare(right), IIntegerItem.NEGATIVE_ONE);</span>
<span class="fc" id="L156">      break;</span>
    case GT:
<span class="fc" id="L158">      retval = OperationFunctions.opNumericGreaterThan(left.compare(right), IIntegerItem.ZERO);</span>
<span class="fc" id="L159">      break;</span>
    case LE:
<span class="fc" id="L161">      retval = OperationFunctions.opNumericLessThan(left.compare(right), IIntegerItem.ONE);</span>
<span class="fc" id="L162">      break;</span>
    case LT:
<span class="fc" id="L164">      retval = OperationFunctions.opNumericLessThan(left.compare(right), IIntegerItem.ZERO);</span>
<span class="fc" id="L165">      break;</span>
    case NE:
<span class="fc" id="L167">      retval = FnNot.fnNot(OperationFunctions.opNumericEqual(left.compare(right), IIntegerItem.ZERO));</span>
<span class="fc" id="L168">      break;</span>
    default:
<span class="nc" id="L170">      throw new IllegalArgumentException(</span>
<span class="nc" id="L171">          String.format(&quot;Unsupported operator '%s'&quot;, operator.name())); // NOPMD</span>
    }
<span class="fc" id="L173">    return retval;</span>
  }

  /**
   * Perform a number-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem numericCompare(@NonNull INumericItem left, @NonNull Operator operator,
      @NonNull INumericItem right) {
    IBooleanItem retval;
<span class="pc bpc" id="L192" title="6 of 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="fc" id="L194">      retval = OperationFunctions.opNumericEqual(left, right);</span>
<span class="fc" id="L195">      break;</span>
    case GE: {
<span class="nc" id="L197">      IBooleanItem gt = OperationFunctions.opNumericGreaterThan(left, right);</span>
<span class="nc" id="L198">      IBooleanItem eq = OperationFunctions.opNumericEqual(left, right);</span>
<span class="nc bnc" id="L199" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L200">      break;</span>
    }
    case GT:
<span class="nc" id="L203">      retval = OperationFunctions.opNumericGreaterThan(left, right);</span>
<span class="nc" id="L204">      break;</span>
    case LE: {
<span class="nc" id="L206">      IBooleanItem lt = OperationFunctions.opNumericLessThan(left, right);</span>
<span class="nc" id="L207">      IBooleanItem eq = OperationFunctions.opNumericEqual(left, right);</span>
<span class="nc bnc" id="L208" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L209">      break;</span>
    }
    case LT:
<span class="nc" id="L212">      retval = OperationFunctions.opNumericLessThan(left, right);</span>
<span class="nc" id="L213">      break;</span>
    case NE:
<span class="nc" id="L215">      retval = FnNot.fnNot(OperationFunctions.opNumericEqual(left, right));</span>
<span class="nc" id="L216">      break;</span>
    default:
<span class="nc" id="L218">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="fc" id="L220">    return retval;</span>
  }

  /**
   * Perform a boolean-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem booleanCompare(@NonNull IBooleanItem left, @NonNull Operator operator,
      @NonNull IBooleanItem right) {
    IBooleanItem retval;
<span class="pc bpc" id="L239" title="1 of 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="fc" id="L241">      retval = OperationFunctions.opBooleanEqual(left, right);</span>
<span class="fc" id="L242">      break;</span>
    case GE: {
<span class="fc" id="L244">      IBooleanItem gt = OperationFunctions.opBooleanGreaterThan(left, right);</span>
<span class="fc" id="L245">      IBooleanItem eq = OperationFunctions.opBooleanEqual(left, right);</span>
<span class="pc bpc" id="L246" title="2 of 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="fc" id="L247">      break;</span>
    }
    case GT:
<span class="fc" id="L250">      retval = OperationFunctions.opBooleanGreaterThan(left, right);</span>
<span class="fc" id="L251">      break;</span>
    case LE: {
<span class="fc" id="L253">      IBooleanItem lt = OperationFunctions.opBooleanLessThan(left, right);</span>
<span class="fc" id="L254">      IBooleanItem eq = OperationFunctions.opBooleanEqual(left, right);</span>
<span class="pc bpc" id="L255" title="2 of 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="fc" id="L256">      break;</span>
    }
    case LT:
<span class="fc" id="L259">      retval = OperationFunctions.opBooleanLessThan(left, right);</span>
<span class="fc" id="L260">      break;</span>
    case NE:
<span class="fc" id="L262">      retval = FnNot.fnNot(OperationFunctions.opBooleanEqual(left, right));</span>
<span class="fc" id="L263">      break;</span>
    default:
<span class="nc" id="L265">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="fc" id="L267">    return retval;</span>
  }

  /**
   * Perform a date and time-based comparison of the {@code right} item against
   * the {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem dateTimeCompare(@NonNull IDateTimeItem left, @NonNull Operator operator,
      @NonNull IDateTimeItem right) {
    IBooleanItem retval;
<span class="nc bnc" id="L286" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L288">      retval = OperationFunctions.opDateTimeEqual(left, right);</span>
<span class="nc" id="L289">      break;</span>
    case GE: {
<span class="nc" id="L291">      IBooleanItem gt = OperationFunctions.opDateTimeGreaterThan(left, right);</span>
<span class="nc" id="L292">      IBooleanItem eq = OperationFunctions.opDateTimeEqual(left, right);</span>
<span class="nc bnc" id="L293" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L294">      break;</span>
    }
    case GT:
<span class="nc" id="L297">      retval = OperationFunctions.opDateTimeGreaterThan(left, right);</span>
<span class="nc" id="L298">      break;</span>
    case LE: {
<span class="nc" id="L300">      IBooleanItem lt = OperationFunctions.opDateTimeLessThan(left, right);</span>
<span class="nc" id="L301">      IBooleanItem eq = OperationFunctions.opDateTimeEqual(left, right);</span>
<span class="nc bnc" id="L302" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L303">      break;</span>
    }
    case LT:
<span class="nc" id="L306">      retval = OperationFunctions.opDateTimeLessThan(left, right);</span>
<span class="nc" id="L307">      break;</span>
    case NE:
<span class="nc" id="L309">      retval = FnNot.fnNot(OperationFunctions.opDateTimeEqual(left, right));</span>
<span class="nc" id="L310">      break;</span>
    default:
<span class="nc" id="L312">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="nc" id="L314">    return retval;</span>
  }

  /**
   * Perform a date-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem dateCompare(@NonNull IDateItem left, @NonNull Operator operator,
      @NonNull IDateItem right) {
    IBooleanItem retval;
<span class="nc bnc" id="L333" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L335">      retval = OperationFunctions.opDateEqual(left, right);</span>
<span class="nc" id="L336">      break;</span>
    case GE: {
<span class="nc" id="L338">      IBooleanItem gt = OperationFunctions.opDateGreaterThan(left, right);</span>
<span class="nc" id="L339">      IBooleanItem eq = OperationFunctions.opDateEqual(left, right);</span>
<span class="nc bnc" id="L340" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L341">      break;</span>
    }
    case GT:
<span class="nc" id="L344">      retval = OperationFunctions.opDateGreaterThan(left, right);</span>
<span class="nc" id="L345">      break;</span>
    case LE: {
<span class="nc" id="L347">      IBooleanItem lt = OperationFunctions.opDateLessThan(left, right);</span>
<span class="nc" id="L348">      IBooleanItem eq = OperationFunctions.opDateEqual(left, right);</span>
<span class="nc bnc" id="L349" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L350">      break;</span>
    }
    case LT:
<span class="nc" id="L353">      retval = OperationFunctions.opDateLessThan(left, right);</span>
<span class="nc" id="L354">      break;</span>
    case NE:
<span class="nc" id="L356">      retval = FnNot.fnNot(OperationFunctions.opDateEqual(left, right));</span>
<span class="nc" id="L357">      break;</span>
    default:
<span class="nc" id="L359">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="nc" id="L361">    return retval;</span>
  }

  /**
   * Perform a duration-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem durationCompare( // NOPMD - unavoidable
      @NonNull IDurationItem left,
      @NonNull Operator operator,
      @NonNull IDurationItem right) {
<span class="nc" id="L381">    IBooleanItem retval = null;</span>
<span class="nc bnc" id="L382" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L384">      retval = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc" id="L385">      break;</span>
    case GE:
<span class="nc bnc" id="L387" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L388">        IBooleanItem gt = OperationFunctions.opYearMonthDurationGreaterThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc" id="L391">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L392" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc bnc" id="L393" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L394">        IBooleanItem gt = OperationFunctions.opDayTimeDurationGreaterThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
<span class="nc" id="L397">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L398" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L399">      }</span>
      break;
    case GT:
<span class="nc bnc" id="L402" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L403">        retval = OperationFunctions.opYearMonthDurationGreaterThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc bnc" id="L406" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L407">        retval = OperationFunctions.opDayTimeDurationGreaterThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
      }
      break;
    case LE:
<span class="nc bnc" id="L413" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L414">        IBooleanItem lt = OperationFunctions.opYearMonthDurationLessThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc" id="L417">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L418" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc bnc" id="L419" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L420">        IBooleanItem lt = OperationFunctions.opDayTimeDurationLessThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
<span class="nc" id="L423">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L424" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L425">      }</span>
      break;
    case LT:
<span class="nc bnc" id="L428" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L429">        retval = OperationFunctions.opYearMonthDurationLessThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc bnc" id="L432" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L433">        retval = OperationFunctions.opDayTimeDurationLessThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
      }
      break;
    case NE:
<span class="nc" id="L439">      retval = FnNot.fnNot(OperationFunctions.opDurationEqual(left, right));</span>
<span class="nc" id="L440">      break;</span>
    default:
<span class="nc" id="L442">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }

<span class="nc bnc" id="L445" title="All 2 branches missed.">    if (retval == null) {</span>
<span class="nc" id="L446">      throw new InvalidTypeMetapathException(</span>
          null,
<span class="nc" id="L448">          String.format(&quot;The item types '%s' and '%s' are not comparable&quot;,</span>
<span class="nc" id="L449">              left.getClass().getName(),</span>
<span class="nc" id="L450">              right.getClass().getName()));</span>
    }
<span class="nc" id="L452">    return retval;</span>
  }

  /**
   * Perform a binary data-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem binaryCompare(@NonNull IBase64BinaryItem left, @NonNull Operator operator,
      @NonNull IBase64BinaryItem right) {
    IBooleanItem retval;
<span class="nc bnc" id="L471" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L473">      retval = OperationFunctions.opBase64BinaryEqual(left, right);</span>
<span class="nc" id="L474">      break;</span>
    case GE: {
<span class="nc" id="L476">      IBooleanItem gt = OperationFunctions.opBase64BinaryGreaterThan(left, right);</span>
<span class="nc" id="L477">      IBooleanItem eq = OperationFunctions.opBase64BinaryEqual(left, right);</span>
<span class="nc bnc" id="L478" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L479">      break;</span>
    }
    case GT:
<span class="nc" id="L482">      retval = OperationFunctions.opBase64BinaryGreaterThan(left, right);</span>
<span class="nc" id="L483">      break;</span>
    case LE: {
<span class="nc" id="L485">      IBooleanItem lt = OperationFunctions.opBase64BinaryLessThan(left, right);</span>
<span class="nc" id="L486">      IBooleanItem eq = OperationFunctions.opBase64BinaryEqual(left, right);</span>
<span class="nc bnc" id="L487" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L488">      break;</span>
    }
    case LT:
<span class="nc" id="L491">      retval = OperationFunctions.opBase64BinaryLessThan(left, right);</span>
<span class="nc" id="L492">      break;</span>
    case NE:
<span class="nc" id="L494">      retval = FnNot.fnNot(OperationFunctions.opBase64BinaryEqual(left, right));</span>
<span class="nc" id="L495">      break;</span>
    default:
<span class="nc" id="L497">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="nc" id="L499">    return retval;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>